è´
kC:\Users\Fatih\source\repos\AdvanceManagement.UI\AdvanceManagement.UI.Base\Controllers\AdvanceController.cs
	namespace 	
AdvanceManagement
 
. 
UI 
. 
Base #
.# $
Controllers$ /
{ 
public 

class 
AdvanceController "
(" #$
AdvanceConnectionService# ;
advanceService< J
,J K$
ProjectConnectionServiceL d
projectServicee s
,s t2
%AdvanceRequestStatusConnectionService	u ö
requestService
õ ©
,
© ™-
FinanceManagerConnectionService
´  
financeService
À Ÿ
,
Ÿ ⁄-
PaymentReceiptControllerService
€ ˙
paymentService
˚ â
)
â ä
:
ã å

Controller
ç ó
{ 
public 
async 
Task 
< 
IActionResult '
>' (
PastAdvance) 4
(4 5
)5 6
{ 	
var 
user 
= 
HttpContext "
." #
Session# *
.* +

GetSession+ 5
<5 6
UserDTO6 =
>= >
(> ?
$str? E
)E F
;F G
var 
data 
= 
await 
advanceService +
.+ ,
BringAll, 4
(4 5
(5 6
int6 9
)9 :
user: >
.> ?
WorkerID? G
)G H
;H I
return 
View 
( 
data 
) 
; 
} 	
[ 	
	Authorize	 
( 
Roles 
= 
$str ;
); <
]< =
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
ApproveAdvance) 7
(7 8
int8 ;
	advanceID< E
,E F
intG J
	requestIDK T
)T U
{ 	
var 
advance 
= 
await 
advanceService  .
.. /
BringByAdvanceID/ ?
(? @
	advanceID@ I
)I J
;J K
var 
requests 
= 
await  
requestService! /
./ 0
BringStatus0 ;
(; <
	advanceID< E
)E F
;F G
var!! 
data!! 
=!! 
new!! 
ApproveAdvanceDTO!! ,
{"" "
AdvanceRequestStatusID## &
=##' (
	requestID##) 2
,##2 3
Advance$$ 
=$$ 
advance$$ !
,$$! " 
AdvanceRequestStatus%% $
=%%% &
requests%%' /
}&& 
;&& 
return(( 
View(( 
((( 
data(( 
)(( 
;(( 
})) 	
[++ 	
	Authorize++	 
(++ 
Roles++ 
=++ 
$str++ +
)+++ ,
]++, -
[,, 	
HttpGet,,	 
],, 
public-- 
async-- 
Task-- 
<-- 
IActionResult-- '
>--' (!
FinancePendingAdvance--) >
(--> ?
)--? @
{.. 	
var00 
data00 
=00 
await00 
advanceService00 +
.00+ ,
BringAllForFinance00, >
(00> ?
)00? @
;00@ A
return11 
View11 
(11 
data11 
)11 
;11 
}22 	
[44 	
	Authorize44	 
(44 
Roles44 
=44 
$str44 +
)44+ ,
]44, -
[55 	
HttpGet55	 
]55 
public66 
async66 
Task66 
<66 
IActionResult66 '
>66' (
FinanceAdvance66) 7
(667 8
int668 ;
	advanceID66< E
)66E F
{77 	
var88 
advance88 
=88 
await88 
advanceService88  .
.88. /
BringByAdvanceID88/ ?
(88? @
	advanceID88@ I
)88I J
;88J K
var:: 
requests:: 
=:: 
await::  
requestService::! /
.::/ 0
BringStatus::0 ;
(::; <
	advanceID::< E
)::E F
;::F G
var<< 
data<< 
=<< 
new<< 
FinanceAdvanceDTO<< ,
{== 
Advance>> 
=>> 
advance>> !
,>>! " 
AdvanceRequestStatus?? $
=??% &
requests??' /
}@@ 
;@@ 
returnBB 
ViewBB 
(BB 
dataBB 
)BB 
;BB 
}DD 	
[FF 	
	AuthorizeFF	 
(FF 
RolesFF 
=FF 
$strFF +
)FF+ ,
]FF, -
[GG 	
HttpPostGG	 
]GG 
publicHH 
asyncHH 
TaskHH 
<HH 
IActionResultHH '
>HH' (
FinanceAdvanceHH) 7
(HH7 8
intHH8 ;
	advanceIDHH< E
,HHE F
DateTimeHHG O
payTimeHHP W
,HHW X
DateTimeHHY a
?HHa b
advanceTimeHHc n
)HHn o
{II 	
varJJ 
userJJ 
=JJ 
HttpContextJJ "
.JJ" #
SessionJJ# *
.JJ* +

GetSessionJJ+ 5
<JJ5 6
UserDTOJJ6 =
>JJ= >
(JJ> ?
$strJJ? E
)JJE F
;JJF G
varKK 
errorKK 
=KK 
newKK 
ErrorDTOKK $
{KK% &

StatusCodeKK' 1
=KK2 3
$numKK4 7
,KK7 8
ErrorMessagesKK9 F
=KKG H
newKKI L
ListKKM Q
<KKQ R
stringKKR X
>KKX Y
{KKZ [
$str	KK\ Ä
}
KKÅ Ç
}
KKÉ Ñ
;
KKÑ Ö
ifLL 
(LL 
advanceTimeLL 
>LL 
payTimeLL %
)LL% &
returnMM 
newMM "
BadRequestObjectResultMM 1
(MM1 2
errorMM2 7
)MM7 8
;MM8 9
varNN 
dataNN 
=NN 
newNN  
FinanceManagerAddDTONN /
{OO 
WorkerIDPP 
=PP 
(PP 
intPP 
)PP  
userPP  $
.PP$ %
WorkerIDPP% -
,PP- .
	AdvanceIDQQ 
=QQ 
	advanceIDQQ %
,QQ% &!
DeterminedPaymentDateRR %
=RR& '
payTimeRR( /
,RR/ 0
IsActiveSS 
=SS 
trueSS 
}TT 
;TT 
ifUU 
(UU 
dataUU 
!=UU 
nullUU 
)UU 
{VV 
awaitWW 
financeServiceWW $
.WW$ %

AddFinanceWW% /
(WW/ 0
dataWW0 4
)WW4 5
;WW5 6
returnXX 
RedirectToActionXX '
(XX' (
$strXX( ?
)XX? @
;XX@ A
}YY 
returnZZ 

BadRequestZZ 
(ZZ 
)ZZ 
;ZZ  
}[[ 	
[]] 	
	Authorize]]	 
(]] 
Roles]] 
=]] 
$str]] ;
)]]; <
]]]< =
public^^ 
async^^ 
Task^^ 
<^^ 
IActionResult^^ '
>^^' (
ApproveAdvance^^) 7
(^^7 8
bool^^8 <

isApproved^^= G
,^^G H
decimal^^I P
approvedAmount^^Q _
,^^_ `
int^^a d
	requestID^^e n
,^^n o
decimal^^p w

lastAmount	^^x Ç
)
^^Ç É
{__ 	
var`` 
user`` 
=`` 
HttpContext`` "
.``" #
Session``# *
.``* +

GetSession``+ 5
<``5 6
UserDTO``6 =
>``= >
(``> ?
$str``? E
)``E F
;``F G
varaa 
erroraa 
=aa 
newaa 
ErrorDTOaa $
{aa% &

StatusCodeaa' 1
=aa2 3
$numaa4 7
,aa7 8
ErrorMessagesaa9 F
=aaG H
newaaI L
ListaaM Q
<aaQ R
stringaaR X
>aaX Y
{aaZ [
$str	aa\ è
}
aaê ë
}
aaí ì
;
aaì î
ifcc 
(cc 

isApprovedcc 
!=cc 
truecc "
)cc" #
{dd 
varee 
dataee 
=ee 
newee )
AdvanceRequestStatusUpdateDTOee <
{ff "
AdvanceRequestStatusIDgg *
=gg+ ,
	requestIDgg- 6
,gg6 7

StatusNamehh 
=hh  
$strhh! -
,hh- .
StatusDescriptionii %
=ii& '
userii( ,
.ii, -

WorkerNameii- 7
+ii8 9
$strii: E
,iiE F
ApprovingRejectedIDjj '
=jj( )
userjj* .
.jj. /
WorkerIDjj/ 7
,jj7 8
ProcessDatekk 
=kk  !
DateTimekk" *
.kk* +
Todaykk+ 0
,kk0 1
ApprovedAmountll "
=ll# $
$numll% &
,ll& '

ModifiedBymm 
=mm  
usermm! %
.mm% &
WorkerIDmm& .
,mm. /
ModifiedDatenn  
=nn! "
DateTimenn# +
.nn+ ,
Todaynn, 1
,nn1 2
IsActiveoo 
=oo 
trueoo #
}pp 
;pp 
awaitqq 
requestServiceqq $
.qq$ %"
ApproveOrDeclineStatusqq% ;
(qq; <
dataqq< @
)qq@ A
;qqA B
returnrr 
RedirectToActionrr '
(rr' (
$strrr( 8
)rr8 9
;rr9 :
}ss 
elsett 
iftt 
(tt 

isApprovedtt 
&&tt  "
approvedAmounttt# 1
<=tt2 4

lastAmounttt5 ?
)tt? @
{uu 
varvv 
datavv 
=vv 
newvv )
AdvanceRequestStatusUpdateDTOvv <
{ww "
AdvanceRequestStatusIDxx *
=xx+ ,
	requestIDxx- 6
,xx6 7

StatusNameyy 
=yy  
$stryy! ,
,yy, -
StatusDescriptionzz %
=zz& '
userzz( ,
.zz, -

WorkerNamezz- 7
+zz8 9
$strzz: E
,zzE F
ApprovingRejectedID{{ '
={{( )
user{{* .
.{{. /
WorkerID{{/ 7
,{{7 8
ProcessDate|| 
=||  !
DateTime||" *
.||* +
Today||+ 0
,||0 1

ModifiedBy}} 
=}}  
user}}! %
.}}% &
WorkerID}}& .
,}}. /
ModifiedDate~~  
=~~! "
DateTime~~# +
.~~+ ,
Today~~, 1
,~~1 2
ApprovedAmount "
=# $
approvedAmount% 3
,3 4
IsActive
ÄÄ 
=
ÄÄ 
true
ÄÄ #
}
ÅÅ 
;
ÅÅ 
await
ÇÇ 
requestService
ÇÇ $
.
ÇÇ$ %$
ApproveOrDeclineStatus
ÇÇ% ;
(
ÇÇ; <
data
ÇÇ< @
)
ÇÇ@ A
;
ÇÇA B
return
ÉÉ 
RedirectToAction
ÉÉ '
(
ÉÉ' (
$str
ÉÉ( 8
)
ÉÉ8 9
;
ÉÉ9 :
}
ÑÑ 
else
ÖÖ 
return
ÜÜ 
new
ÜÜ $
BadRequestObjectResult
ÜÜ 1
(
ÜÜ1 2
error
ÜÜ2 7
)
ÜÜ7 8
;
ÜÜ8 9
}
áá 	
[
ää 	
	Authorize
ää	 
(
ää 
Roles
ää 
=
ää 
$str
ää ;
)
ää; <
]
ää< =
public
ãã 
async
ãã 
Task
ãã 
<
ãã 
IActionResult
ãã '
>
ãã' (
PendingAdvance
ãã) 7
(
ãã7 8
)
ãã8 9
{
åå 	
var
çç 
user
çç 
=
çç 
HttpContext
çç "
.
çç" #
Session
çç# *
.
çç* +

GetSession
çç+ 5
<
çç5 6
UserDTO
çç6 =
>
çç= >
(
çç> ?
$str
çç? E
)
ççE F
;
ççF G
List
éé 
<
éé +
AdvanceRequestStatusSelectDTO
éé .
>
éé. /
data
éé0 4
;
éé4 5
if
èè 
(
èè 
user
èè 
.
èè 
TitleID
èè 
!=
èè 
$num
èè  
)
èè  !
{
êê 
data
ëë 
=
ëë 
await
ëë 
requestService
ëë +
.
ëë+ , 
BringApproveStatus
ëë, >
(
ëë> ?
(
ëë? @
int
ëë@ C
)
ëëC D
user
ëëD H
.
ëëH I
TitleID
ëëI P
)
ëëP Q
;
ëëQ R
}
íí 
else
ìì 
{
îî 
data
ïï 
=
ïï 
await
ïï 
requestService
ïï +
.
ïï+ ,$
BringApproveUnitStatus
ïï, B
(
ïïB C
(
ïïC D
int
ïïD G
)
ïïG H
user
ïïH L
.
ïïL M
TitleID
ïïM T
)
ïïT U
;
ïïU V
}
ññ 
return
òò 
View
òò 
(
òò 
data
òò 
)
òò 
;
òò 
}
ôô 	
public
úú 
async
úú 
Task
úú 
<
úú 
IActionResult
úú '
>
úú' (
AdvanceDetail
úú) 6
(
úú6 7
int
úú7 :
	advanceID
úú; D
)
úúD E
{
ùù 	
var
ûû 
data
ûû 
=
ûû 
await
ûû 
requestService
ûû +
.
ûû+ ,
BringStatus
ûû, 7
(
ûû7 8
	advanceID
ûû8 A
)
ûûA B
;
ûûB C
if
†† 
(
†† 
data
†† 
!=
†† 
null
†† 
)
†† 
return
°° 
View
°° 
(
°° 
data
°°  
)
°°  !
;
°°! "
return
££ 

BadRequest
££ 
(
££ 
)
££ 
;
££  
}
§§ 	
[
¶¶ 	
HttpGet
¶¶	 
]
¶¶ 
public
ßß 
async
ßß 
Task
ßß 
<
ßß 
IActionResult
ßß '
>
ßß' (

AddAdvance
ßß) 3
(
ßß3 4
)
ßß4 5
{
®® 	
var
©© 
worker
©© 
=
©© 
HttpContext
©© $
.
©©$ %
Session
©©% ,
.
©©, -

GetSession
©©- 7
<
©©7 8
UserDTO
©©8 ?
>
©©? @
(
©©@ A
$str
©©A G
)
©©G H
;
©©H I
var
¨¨ 
projects
¨¨ 
=
¨¨ 
await
¨¨  
projectService
¨¨! /
.
¨¨/ 0
BringProject
¨¨0 <
(
¨¨< =
(
¨¨= >
int
¨¨> A
)
¨¨A B
worker
¨¨B H
.
¨¨H I
WorkerID
¨¨I Q
)
¨¨Q R
;
¨¨R S
var
≠≠ 
data
≠≠ 
=
≠≠ 
new
≠≠ 
AdvanceAddDTO
≠≠ (
{
ÆÆ 
Projects
ØØ 
=
ØØ 
projects
ØØ #
.
ØØ# $
Select
ØØ$ *
(
ØØ* +
x
ØØ+ ,
=>
ØØ- /
new
ØØ0 3
SelectListItem
ØØ4 B
{
∞∞ 
Value
±± 
=
±± 
x
±± 
.
±± 
	ProjectID
±± '
.
±±' (
ToString
±±( 0
(
±±0 1
)
±±1 2
,
±±2 3
Text
≤≤ 
=
≤≤ 
x
≤≤ 
.
≤≤ 
ProjectName
≤≤ (
}
≥≥ 
)
≥≥ 
.
≥≥ 
ToList
≥≥ 
(
≥≥ 
)
≥≥ 
}
¥¥ 
;
¥¥ 
return
µµ 
View
µµ 
(
µµ 
data
µµ 
)
µµ 
;
µµ 
}
∂∂ 	
[
ππ 	
HttpPost
ππ	 
]
ππ 
public
∫∫ 
async
∫∫ 
Task
∫∫ 
<
∫∫ 
IActionResult
∫∫ '
>
∫∫' (

AddAdvance
∫∫) 3
(
∫∫3 4
AdvanceAddDTO
∫∫4 A
advance
∫∫B I
)
∫∫I J
{
ªª 	
var
ºº 
worker
ºº 
=
ºº 
HttpContext
ºº $
.
ºº$ %
Session
ºº% ,
.
ºº, -

GetSession
ºº- 7
<
ºº7 8
UserDTO
ºº8 ?
>
ºº? @
(
ºº@ A
$str
ººA G
)
ººG H
;
ººH I
advance
ΩΩ 
.
ΩΩ 
WorkerID
ΩΩ 
=
ΩΩ 
worker
ΩΩ %
.
ΩΩ% &
WorkerID
ΩΩ& .
;
ΩΩ. /
var
ææ 
data
ææ 
=
ææ 
await
ææ 
advanceService
ææ +
.
ææ+ ,

AddAdvance
ææ, 6
(
ææ6 7
advance
ææ7 >
)
ææ> ?
;
ææ? @
if
¿¿ 
(
¿¿ 
data
¿¿ 
)
¿¿ 
{
¡¡ 
return
¬¬ 
RedirectToAction
¬¬ '
(
¬¬' (
$str
¬¬( 4
)
¬¬4 5
;
¬¬5 6
}
√√ 
return
≈≈ 
new
≈≈ $
BadRequestObjectResult
≈≈ -
(
≈≈- .
new
≈≈. 1
ErrorDTO
≈≈2 :
{
≈≈; <

StatusCode
≈≈< F
=
≈≈G H
$num
≈≈I L
,
≈≈L M
ErrorMessages
≈≈N [
=
≈≈\ ]
new
≈≈^ a
List
≈≈b f
<
≈≈f g
string
≈≈g m
>
≈≈m n
{
≈≈o p
$str≈≈p ù
}≈≈ù û
}≈≈ü †
)≈≈† °
;≈≈° ¢
}
»» 	
[
ÀÀ 	
	Authorize
ÀÀ	 
(
ÀÀ 
Roles
ÀÀ 
=
ÀÀ 
$str
ÀÀ '
)
ÀÀ' (
]
ÀÀ( )
[
ÃÃ 	
HttpGet
ÃÃ	 
]
ÃÃ 
public
ÕÕ 
async
ÕÕ 
Task
ÕÕ 
<
ÕÕ 
IActionResult
ÕÕ '
>
ÕÕ' (&
AccountantPendingAdvance
ÕÕ) A
(
ÕÕA B
)
ÕÕB C
{
ŒŒ 	
var
œœ 
data
œœ 
=
œœ 
await
œœ 
advanceService
œœ +
.
œœ+ ,#
BringAllForAccountant
œœ, A
(
œœA B
)
œœB C
;
œœC D
return
–– 
View
–– 
(
–– 
data
–– 
)
–– 
;
–– 
}
—— 	
[
‘‘ 	
	Authorize
‘‘	 
(
‘‘ 
Roles
‘‘ 
=
‘‘ 
$str
‘‘ '
)
‘‘' (
]
‘‘( )
[
’’ 	
HttpGet
’’	 
]
’’ 
public
÷÷ 
async
÷÷ 
Task
÷÷ 
<
÷÷ 
IActionResult
÷÷ '
>
÷÷' (
AccountantAdvance
÷÷) :
(
÷÷: ;
int
÷÷; >
	advanceID
÷÷? H
)
÷÷H I
{
◊◊ 	
var
ÿÿ 
advance
ÿÿ 
=
ÿÿ 
await
ÿÿ 
advanceService
ÿÿ  .
.
ÿÿ. /
BringByAdvanceID
ÿÿ/ ?
(
ÿÿ? @
	advanceID
ÿÿ@ I
)
ÿÿI J
;
ÿÿJ K
var
⁄⁄ 
requests
⁄⁄ 
=
⁄⁄ 
await
⁄⁄  
requestService
⁄⁄! /
.
⁄⁄/ 0
BringStatus
⁄⁄0 ;
(
⁄⁄; <
	advanceID
⁄⁄< E
)
⁄⁄E F
;
⁄⁄F G
var
‹‹ 
data
‹‹ 
=
‹‹ 
new
‹‹ "
AccountantAdvanceDTO
‹‹ /
{
›› 
Advance
ﬁﬁ 
=
ﬁﬁ 
advance
ﬁﬁ !
,
ﬁﬁ! ""
AdvanceRequestStatus
ﬂﬂ $
=
ﬂﬂ% &
requests
ﬂﬂ' /
}
‡‡ 
;
‡‡ 
return
‚‚ 
View
‚‚ 
(
‚‚ 
data
‚‚ 
)
‚‚ 
;
‚‚ 
}
„„ 	
[
ÊÊ 	
	Authorize
ÊÊ	 
(
ÊÊ 
Roles
ÊÊ 
=
ÊÊ 
$str
ÊÊ '
)
ÊÊ' (
]
ÊÊ( )
[
ÁÁ 	
HttpPost
ÁÁ	 
]
ÁÁ 
public
ËË 
async
ËË 
Task
ËË 
<
ËË 
IActionResult
ËË '
>
ËË' (
AccountantAdvance
ËË) :
(
ËË: ;
int
ËË; >
	advanceID
ËË? H
,
ËËH I
string
ËËJ P
receiptDesc
ËËQ \
)
ËË\ ]
{
ÈÈ 	
var
ÍÍ 
data
ÍÍ 
=
ÍÍ 
new
ÍÍ "
PaymentReceiptAddDTO
ÍÍ /
{
ÎÎ 
ReceiptDate
ÏÏ 
=
ÏÏ 
DateTime
ÏÏ &
.
ÏÏ& '
Today
ÏÏ' ,
,
ÏÏ, - 
ReceiptDescription
ÌÌ "
=
ÌÌ# $
receiptDesc
ÌÌ% 0
,
ÌÌ0 1
	AdvanceID
ÓÓ 
=
ÓÓ 
	advanceID
ÓÓ %
,
ÓÓ% &
CreatedDate
ÔÔ 
=
ÔÔ 
DateTime
ÔÔ &
.
ÔÔ& '
Today
ÔÔ' ,
,
ÔÔ, -
IsActive
 
=
 
true
 
}
ÒÒ 
;
ÒÒ 
var
ÛÛ 
value
ÛÛ 
=
ÛÛ 
await
ÛÛ 
paymentService
ÛÛ ,
.
ÛÛ, -
AddPaymentReceipt
ÛÛ- >
(
ÛÛ> ?
data
ÛÛ? C
)
ÛÛC D
;
ÛÛD E
if
ÙÙ 
(
ÙÙ 
value
ÙÙ 
)
ÙÙ 
return
ıı 
RedirectToAction
ıı '
(
ıı' (
$str
ıı( B
)
ııB C
;
ııC D
else
ˆˆ 
return
˜˜ 

BadRequest
˜˜ !
(
˜˜! "
)
˜˜" #
;
˜˜# $
}
¯¯ 	
}
˘˘ 
}˙˙  
hC:\Users\Fatih\source\repos\AdvanceManagement.UI\AdvanceManagement.UI.Base\Controllers\HomeController.cs
	namespace 	
AdvanceManagement
 
. 
UI 
. 
Base #
.# $
Controllers$ /
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private		 
readonly		 
ILogger		  
<		  !
HomeController		! /
>		/ 0
_logger		1 8
;		8 9
public 
HomeController 
( 
ILogger %
<% &
HomeController& 4
>4 5
logger6 <
)< =
{ 	
_logger 
= 
logger 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Privacy $
($ %
)% &
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
ResponseCache	 
( 
Duration 
=  !
$num" #
,# $
Location% -
=. /!
ResponseCacheLocation0 E
.E F
NoneF J
,J K
NoStoreL S
=T U
trueV Z
)Z [
][ \
public 
IActionResult 
Error "
(" #
)# $
{ 	
return 
View 
( 
new 
ErrorViewModel *
{+ ,
	RequestId- 6
=7 8
Activity9 A
.A B
CurrentB I
?I J
.J K
IdK M
??N P
HttpContextQ \
.\ ]
TraceIdentifier] l
}m n
)n o
;o p
} 	
} 
}   èN
iC:\Users\Fatih\source\repos\AdvanceManagement.UI\AdvanceManagement.UI.Base\Controllers\LoginController.cs
	namespace 	
AdvanceManagement
 
. 
UI 
. 
Base #
.# $
Controllers$ /
{ 
public 

class 
LoginController  
(  !"
LoginConnectionService! 7
service8 ?
)? @
:A B

ControllerC M
{ 
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpPost	 
] 
[ 	$
ValidateAntiForgeryToken	 !
]! "
public 
async 
Task 
< 
IActionResult '
>' (
Login) .
(. /
LoginDTO/ 7
dto8 ;
); <
{ 	
var 
token 
= 
await 
service %
.% &
Login& +
(+ ,
dto, /
./ 0
User0 4
)4 5
;5 6
if 
( 
token 
!= 
$str 
) 
{ 
HttpContext 
. 
Response $
.$ %
Cookies% ,
., -
Append- 3
(3 4
$str4 ;
,; <
token= B
,B C
newD G
CookieOptionsH U
{V W
ExpiresX _
=` a
Systemb h
.h i
DateTimeOffseti w
.w x
Nowx {
.{ |

AddMinutes	| Ü
(
Ü á
$num
á â
)
â ä
}
ä ã
)
ã å
;
å ç
var 
handler 
= 
new !#
JwtSecurityTokenHandler" 9
(9 :
): ;
;; <
var 
	jsonToken 
= 
handler  '
.' (
	ReadToken( 1
(1 2
token2 7
)7 8
as9 ;
JwtSecurityToken< L
;L M
var## 
user## 
=## 
new## 
UserDTO## &
{$$ 
Username%% 
=%% 
	jsonToken%% (
.%%( )
Claims%%) /
.%%/ 0
ToList%%0 6
(%%6 7
)%%7 8
[%%8 9
$num%%9 :
]%%: ;
.%%; <
Value%%< A
,%%A B
RoleName&& 
=&& 
	jsonToken&& (
.&&( )
Claims&&) /
.&&/ 0
ToList&&0 6
(&&6 7
)&&7 8
[&&8 9
$num&&9 :
]&&: ;
.&&; <
Value&&< A
,&&A B
TitleID'' 
='' 
int'' !
.''! "
TryParse''" *
(''* +
	jsonToken''+ 4
?''4 5
.''5 6
Claims''6 <
.''< =
FirstOrDefault''= K
(''K L
claim''L Q
=>''R T
claim''U Z
.''Z [
Type''[ _
==''` b
$str''c l
)''l m
?''m n
.''n o
Value''o t
,''t u
out''v y
var''z }
titleID	''~ Ö
)
''Ö Ü
?
''á à
titleID
''â ê
:
''ë í
(
''ì î
int
''î ó
?
''ó ò
)
''ò ô
null
''ô ù
,
''ù û
WorkerID(( 
=(( 
int(( "
.((" #
TryParse((# +
(((+ ,
	jsonToken((, 5
?((5 6
.((6 7
Claims((7 =
.((= >
FirstOrDefault((> L
(((L M
claim((M R
=>((S U
claim((V [
.(([ \
Type((\ `
==((a c
$str((d n
)((n o
?((o p
.((p q
Value((q v
,((v w
out((x {
var((| 
workerID
((Ä à
)
((à â
?
((ä ã
workerID
((å î
:
((ï ñ
(
((ó ò
int
((ò õ
?
((õ ú
)
((ú ù
null
((ù °
,
((° ¢

WorkerName)) 
=))  
	jsonToken))! *
?))* +
.))+ ,
Claims)), 2
.))2 3
FirstOrDefault))3 A
())A B
claim))B G
=>))H J
claim))K P
.))P Q
Type))Q U
==))V X
$str))Y e
)))e f
?))f g
.))g h
Value))h m
}** 
;** 
HttpContext-- 
.-- 
Session-- #
.--# $

SetSession--$ .
<--. /
UserDTO--/ 6
>--6 7
(--7 8
$str--8 >
,--> ?
user--@ D
)--D E
;--E F
var00 
claims00 
=00 
new00  
List00! %
<00% &
Claim00& +
>00+ ,
(00, -
)00- .
{11 
new22 
Claim22 
(22 

ClaimTypes22 (
.22( )
Name22) -
,22- .
user22. 2
.222 3
Username223 ;
)22; <
,22< =
new33 
Claim33 
(33 

ClaimTypes33 (
.33( )
Role33) -
,33- .
user33/ 3
.333 4
RoleName334 <
)33< =
,33= >
new44 
Claim44 
(44 
$str44 '
,44' (
user44) -
.44- .
TitleID44. 5
.445 6
ToString446 >
(44> ?
)44? @
)44@ A
,44A B
new55 
Claim55 
(55 
$str55 (
,55( )
user55* .
.55. /
WorkerID55/ 7
.557 8
ToString558 @
(55@ A
)55A B
)55B C
,55C D
new66 
Claim66 
(66 
$str66 *
,66* +
user66, 0
.660 1

WorkerName661 ;
)66; <
}77 
;77 
var99 
userIdentity99  
=99! "
new99# &
ClaimsIdentity99' 5
(995 6
claims996 <
,99< =
$str99> E
)99E F
;99F G
var:: 
userPrincipal:: !
=::" #
new::$ '
ClaimsPrincipal::( 7
(::7 8
userIdentity::8 D
)::D E
;::E F
await<< 
HttpContext<< !
.<<! "
SignInAsync<<" -
(<<- .(
CookieAuthenticationDefaults<<. J
.<<J K 
AuthenticationScheme<<K _
,<<_ `
userPrincipal<<a n
,<<n o
new<<p s%
AuthenticationProperties	<<t å
{== 

ExpiresUtc>> 
=>>  
DateTimeOffset>>! /
.>>/ 0
UtcNow>>0 6
.>>6 7

AddMinutes>>7 A
(>>A B
$num>>B D
)>>D E
,>>E F
IsPersistent??  
=??! "
false??# (
,??( )
AllowRefresh@@  
=@@! "
false@@# (
}AA 
)AA 
;AA 
returnFF 
RedirectToActionFF '
(FF' (
$strFF( /
,FF/ 0
$strFF1 7
)FF7 8
;FF8 9
}II 
returnJJ 
RedirectToActionJJ #
(JJ# $
$strJJ$ +
,JJ+ ,
$strJJ- 4
)JJ4 5
;JJ5 6
}KK 	
[NN 	
HttpPostNN	 
]NN 
[OO 	$
ValidateAntiForgeryTokenOO	 !
]OO! "
publicPP 
asyncPP 
TaskPP 
<PP 
IActionResultPP '
>PP' (
RegisterPP) 1
(PP1 2
LoginDTOPP2 :
dtoPP; >
)PP> ?
{QQ 	
dtoRR 
.RR 
UserAddRR 
.RR 
IsActiveRR  
=RR! "
trueRR# '
;RR' (
dtoSS 
.SS 
WorkerSS 
.SS 
IsActiveSS 
=SS  !
trueSS" &
;SS& '
varTT 
valueTT 
=TT 
awaitTT 
serviceTT %
.TT% &
RegisterTT& .
(TT. /
newTT/ 2
APITT3 6
.TT6 7
DataTransferTT7 C
.TTC D
DataTransferObjectsTTD W
.TTW X
ComplexTTX _
.TT_ `
RegisterDTOTT` k
{TTl m
UserTTm q
=TTr s
dtoTTt w
.TTw x
UserAddTTx 
,
TTÄ Å
Worker
TTÇ à
=
TTâ ä
dto
TTã é
.
TTé è
Worker
TTè ï
}
TTï ñ
)
TTñ ó
;
TTó ò
ifVV 
(VV 
valueVV 
)VV 
{WW 
returnXX 
RedirectToActionXX '
(XX' (
$strXX( /
)XX/ 0
;XX0 1
}YY 
return[[ 
View[[ 
([[ 
)[[ 
;[[ 
}\\ 	
public__ 
async__ 
Task__ 
<__ 
IActionResult__ '
>__' (
Logout__) /
(__/ 0
)__0 1
{`` 	
awaitbb 
HttpContextbb 
.bb 
SignOutAsyncbb *
(bb* +(
CookieAuthenticationDefaultsbb+ G
.bbG H 
AuthenticationSchemebbH \
)bb\ ]
;bb] ^
HttpContextee 
.ee 
Responseee  
.ee  !
Cookiesee! (
.ee( )
Deleteee) /
(ee/ 0
$stree0 7
)ee7 8
;ee8 9
HttpContexthh 
.hh 
Sessionhh 
.hh  
Clearhh  %
(hh% &
)hh& '
;hh' (
returnjj 
RedirectToActionjj #
(jj# $
$strjj$ +
,jj+ ,
$strjj- 4
)jj4 5
;jj5 6
}kk 	
}ll 
}mm ¯
iC:\Users\Fatih\source\repos\AdvanceManagement.UI\AdvanceManagement.UI.Base\Extensions\SessionExtension.cs
	namespace 	
AdvanceManagement
 
. 
UI 
. 
Base #
.# $

Extensions$ .
{ 
public 

static 
class 
SessionExtension (
{ 
public 
static 
void 

SetSession %
<% &
T& '
>' (
(( )
this) -
ISession. 6
session7 >
,> ?
string@ F
keyG J
,J K
TL M
valueN S
)S T
{ 	
session		 
.		 
	SetString		 
(		 
key		 !
,		! "
JsonSerializer		# 1
.		1 2
	Serialize		2 ;
(		; <
value		< A
)		A B
)		B C
;		C D
}

 	
public 
static 
T 
? 

GetSession #
<# $
T$ %
>% &
(& '
this' +
ISession, 4
session5 <
,< =
string> D
keyE H
)H I
{ 	
var 
value 
= 
session 
.  
	GetString  )
() *
key* -
)- .
;. /
return 
value 
== 
null  
?! "
default# *
:+ ,
JsonSerializer- ;
.; <
Deserialize< G
<G H
TH I
>I J
(J K
valueK P
)P Q
;Q R
} 	
public 
static 
void 
RemoveSession (
(( )
this) -
ISession. 6
session7 >
,> ?
string@ F
keyG J
)J K
{ 	
session 
. 
Remove 
( 
key 
) 
;  
} 	
} 
} Ö
cC:\Users\Fatih\source\repos\AdvanceManagement.UI\AdvanceManagement.UI.Base\Models\ErrorViewModel.cs
	namespace 	
AdvanceManagement
 
. 
UI 
. 
Base #
.# $
Models$ *
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 ≤C
UC:\Users\Fatih\source\repos\AdvanceManagement.UI\AdvanceManagement.UI.Base\Program.cs
var

 
builder

 
=

 
WebApplication

 
.

 
CreateBuilder

 *
(

* +
args

+ /
)

/ 0
;

0 1
builder 
. 
Services 
. #
AddControllersWithViews (
(( )
)) *
;* +
builder 
. 
Services 
. 
	AddScoped 
< "
LoginConnectionService 1
>1 2
(2 3
)3 4
;4 5
builder 
. 
Services 
. 
AddHttpClient 
< "
LoginConnectionService 5
>5 6
(6 7
conf7 ;
=>< >
{ 
conf 
. 	
BaseAddress	 
= 
new 
Uri 
( 
$str <
)< =
;= >
} 
) 
; 
builder 
. 
Services 
. 
	AddScoped 
< $
AdvanceConnectionService 3
>3 4
(4 5
)5 6
;6 7
builder 
. 
Services 
. 
AddHttpClient 
< $
AdvanceConnectionService 7
>7 8
(8 9
conf9 =
=>> @
{ 
conf 
. 	
BaseAddress	 
= 
new 
Uri 
( 
$str <
)< =
;= >
} 
) 
; 
builder 
. 
Services 
. 
	AddScoped 
< 1
%AdvanceRequestStatusConnectionService @
>@ A
(A B
)B C
;C D
builder 
. 
Services 
. 
AddHttpClient 
< 1
%AdvanceRequestStatusConnectionService D
>D E
(E F
confF J
=>K M
{ 
conf 
. 	
BaseAddress	 
= 
new 
Uri 
( 
$str <
)< =
;= >
} 
) 
; 
builder 
. 
Services 
. 
	AddScoped 
< +
FinanceManagerConnectionService :
>: ;
(; <
)< =
;= >
builder   
.   
Services   
.   
AddHttpClient   
<   +
FinanceManagerConnectionService   >
>  > ?
(  ? @
conf  @ D
=>  E G
{!! 
conf"" 
."" 	
BaseAddress""	 
="" 
new"" 
Uri"" 
("" 
$str"" <
)""< =
;""= >
}## 
)## 
;## 
builder%% 
.%% 
Services%% 
.%% %
AddDistributedMemoryCache%% *
(%%* +
)%%+ ,
;%%, -
builder'' 
.'' 
Services'' 
.'' 
	AddScoped'' 
<'' $
ProjectConnectionService'' 3
>''3 4
(''4 5
)''5 6
;''6 7
builder(( 
.(( 
Services(( 
.(( 
AddHttpClient(( 
<(( $
ProjectConnectionService(( 7
>((7 8
(((8 9
conf((9 =
=>((> @
{)) 
conf** 
.** 	
BaseAddress**	 
=** 
new** 
Uri** 
(** 
$str** <
)**< =
;**= >
}++ 
)++ 
;++ 
builder-- 
.-- 
Services-- 
.-- 
	AddScoped-- 
<-- +
PaymentReceiptControllerService-- :
>--: ;
(--; <
)--< =
;--= >
builder.. 
... 
Services.. 
... 
AddHttpClient.. 
<.. +
PaymentReceiptControllerService.. >
>..> ?
(..? @
conf..@ D
=>..E G
{// 
conf00 
.00 	
BaseAddress00	 
=00 
new00 
Uri00 
(00 
$str00 <
)00< =
;00= >
}11 
)11 
;11 
builder44 
.44 
Services44 
.44 
AddCors44 
(44 
opt44 
=>44 
{55 
opt66 
.66 
AddDefaultPolicy66 
(66 
a66 
=>66 
a66 
.66  
WithOrigins66  +
(66+ ,
)66, -
.66- .
AllowAnyHeader66. <
(66< =
)66= >
.66> ?
AllowAnyMethod66? M
(66M N
)66N O
)66O P
;66P Q
}77 
)77 
;77 
builder88 
.88 
Services88 
.88 
AddAuthentication88 "
(88" #
a88# $
=>88% '
{99 
a:: 
.:: %
DefaultAuthenticateScheme:: 
=::  !(
CookieAuthenticationDefaults::" >
.::> ? 
AuthenticationScheme::? S
;::S T
a;; 
.;; 
DefaultSignInScheme;; 
=;; (
CookieAuthenticationDefaults;; 8
.;;8 9 
AuthenticationScheme;;9 M
;;;M N
}<< 
)<< 
.<< 
	AddCookie<< 
(<< 
a<< 
=><< 
{== 
a>> 
.>> 
	LoginPath>> 
=>> 
$str>>  
;>>  !
a?? 
.?? 
Cookie?? 
.?? 
Name?? 
=?? (
CookieAuthenticationDefaults?? 0
.??0 1 
AuthenticationScheme??1 E
;??E F
a@@ 
.@@ 
Cookie@@ 
.@@ 
HttpOnly@@ 
=@@ 
true@@ 
;@@ 
}AA 
)AA 
;AA 
builderBB 
.BB 
ServicesBB 
.BB 
AddAuthorizationBB !
(BB! "
)BB" #
;BB# $
builderCC 
.CC 
ServicesCC 
.CC 

AddSessionCC 
(CC 
optCC 
=>CC  "
{DD 
optEE 
.EE 
IdleTimeoutEE 
=EE 
TimeSpanEE 
.EE 
FromMinutesEE *
(EE* +
$numEE+ -
)EE- .
;EE. /
optFF 
.FF 
CookieFF 
.FF 
IsEssentialFF 
=FF 
trueFF !
;FF! "
}GG 
)GG 
;GG 
builderII 
.II 
ServicesII 
.II 
	AddScopedII 
<II 
AuthorizeAttributeII -
>II- .
(II. /
)II/ 0
;II0 1
builderJJ 
.JJ 
ServicesJJ 
.JJ 
	AddScopedJJ 
<JJ 
AuthorizeFilterJJ *
>JJ* +
(JJ+ ,
)JJ, -
;JJ- .
varLL 
appLL 
=LL 	
builderLL
 
.LL 
BuildLL 
(LL 
)LL 
;LL 
ifOO 
(OO 
!OO 
appOO 
.OO 	
EnvironmentOO	 
.OO 
IsDevelopmentOO "
(OO" #
)OO# $
)OO$ %
{PP 
appQQ 
.QQ 
UseExceptionHandlerQQ 
(QQ 
$strQQ )
)QQ) *
;QQ* +
}RR 
appSS 
.SS 
UseStaticFilesSS 
(SS 
)SS 
;SS 
appUU 
.UU 

UseRoutingUU 
(UU 
)UU 
;UU 
appWW 
.WW 

UseSessionWW 
(WW 
)WW 
;WW 
appYY 
.YY 
UseAuthenticationYY 
(YY 
)YY 
;YY 
appZZ 
.ZZ 
UseAuthorizationZZ 
(ZZ 
)ZZ 
;ZZ 
app\\ 
.\\ 
MapControllerRoute\\ 
(\\ 
name]] 
:]] 	
$str]]
 
,]] 
pattern^^ 
:^^ 
$str^^ 6
)^^6 7
;^^7 8
app`` 
.`` 
Run`` 
(`` 
)`` 	
;``	 
ó
rC:\Users\Fatih\source\repos\AdvanceManagement.UI\AdvanceManagement.UI.Base\ViewComponents\SideMenuViewComponent.cs
	namespace		 	
AdvanceManagement		
 
.		 
UI		 
.		 
Base		 #
.		# $
ViewComponents		$ 2
{

 
public 

class !
SideMenuViewComponent &
:' (
ViewComponent) 6
{ 
private 
readonly "
LoginConnectionService /
service0 7
;7 8
public !
SideMenuViewComponent $
($ %"
LoginConnectionService% ;
service< C
)C D
{ 	
this 
. 
service 
= 
service "
;" #
} 	
public 
async 
Task 
<  
IViewComponentResult .
>. /
InvokeAsync0 ;
(; <
)< =
{ 	
var 
user 
= 
HttpContext "
." #
Session# *
.* +

GetSession+ 5
<5 6
UserDTO6 =
>= >
(> ?
$str? E
)E F
;F G
var 
data 
= 
await 
service $
.$ %
GetAuthorization% 5
(5 6
user6 :
.: ;
Username; C
)C D
;D E
var 
pageData 
= 
new 
SideMenuDTO *
{ 
PageAuthoriation  
=! "
data# '
,' (
Rolename 
= 
user 
.  
RoleName  (
,( )

WorkerName 
= 
user !
.! "

WorkerName" ,
} 
; 
return!! 
View!! 
(!! 
pageData!!  
)!!  !
;!!! "
}"" 	
}## 
}$$ 